<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>4 MIDFIELD Pre-Institute Workshop | midfield-workshops.utf8.md</title>
  <meta name="description" content="A public site for workshops for access to MIDFIELD">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="4 MIDFIELD Pre-Institute Workshop | midfield-workshops.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A public site for workshops for access to MIDFIELD" />
  <meta name="github-repo" content="MIDFIELDR/workshops" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 MIDFIELD Pre-Institute Workshop | midfield-workshops.utf8.md" />
  
  <meta name="twitter:description" content="A public site for workshops for access to MIDFIELD" />
  



<meta name="date" content="2019-05-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="getting-started.html">
<link rel="next" href="day-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MIDFIELD Workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> MIDFIELD Workshops</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-midfield"><i class="fa fa-check"></i><b>1.1</b> What is MIDFIELD?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#what-is-midfieldr"><i class="fa fa-check"></i><b>1.2</b> What is midfieldr?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>1.3</b> Why R?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#why-r-graphics"><i class="fa fa-check"></i><b>1.4</b> Why R graphics?</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#publications"><i class="fa fa-check"></i><b>1.5</b> Publications</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#facilitators"><i class="fa fa-check"></i><b>1.6</b> Facilitators</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgment"><i class="fa fa-check"></i>Acknowledgment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html"><i class="fa fa-check"></i><b>2</b> MIDFIELD Institute 2019</a><ul>
<li class="chapter" data-level="2.1" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html#description"><i class="fa fa-check"></i><b>2.1</b> Description</a></li>
<li class="chapter" data-level="2.2" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html#before-you-arrive"><i class="fa fa-check"></i><b>2.2</b> Before you arrive</a></li>
<li class="chapter" data-level="2.3" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html#day0agenda"><i class="fa fa-check"></i><b>2.3</b> Sunday agenda</a></li>
<li class="chapter" data-level="2.4" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html#day1agenda"><i class="fa fa-check"></i><b>2.4</b> Monday agenda</a></li>
<li class="chapter" data-level="2.5" data-path="midfield-institute-2019.html"><a href="midfield-institute-2019.html#day2agenda"><i class="fa fa-check"></i><b>2.5</b> Tuesday agenda</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started with R</a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#install-R-and-RStudio"><i class="fa fa-check"></i><b>3.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#install-an-r-package"><i class="fa fa-check"></i><b>3.2</b> Install an R package</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#install-midfieldr"><i class="fa fa-check"></i><b>3.3</b> Install midfielddata and midfieldr</a></li>
<li class="chapter" data-level="3.4" data-path="getting-started.html"><a href="getting-started.html#create-an-r-project"><i class="fa fa-check"></i><b>3.4</b> Create an R project</a></li>
<li class="chapter" data-level="3.5" data-path="getting-started.html"><a href="getting-started.html#create-directories"><i class="fa fa-check"></i><b>3.5</b> Create directories</a></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-0.html"><a href="day-0.html"><i class="fa fa-check"></i><b>4</b> MIDFIELD Pre-Institute Workshop</a><ul>
<li class="chapter" data-level="4.1" data-path="day-0.html"><a href="day-0.html#r-basics"><i class="fa fa-check"></i><b>4.1</b> R basics</a><ul>
<li class="chapter" data-level="4.1.1" data-path="day-0.html"><a href="day-0.html#prerequisites"><i class="fa fa-check"></i><b>4.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.1.2" data-path="day-0.html"><a href="day-0.html#everything-in-r-has-a-name"><i class="fa fa-check"></i><b>4.1.2</b> Everything in R has a name</a></li>
<li class="chapter" data-level="4.1.3" data-path="day-0.html"><a href="day-0.html#everything-in-r-is-an-object"><i class="fa fa-check"></i><b>4.1.3</b> Everything in R is an object</a></li>
<li class="chapter" data-level="4.1.4" data-path="day-0.html"><a href="day-0.html#do-things-in-r-using-functions"><i class="fa fa-check"></i><b>4.1.4</b> Do things in R using functions</a></li>
<li class="chapter" data-level="4.1.5" data-path="day-0.html"><a href="day-0.html#r-functions-come-in-packages"><i class="fa fa-check"></i><b>4.1.5</b> R functions come in packages</a></li>
<li class="chapter" data-level="4.1.6" data-path="day-0.html"><a href="day-0.html#r-objects-have-class"><i class="fa fa-check"></i><b>4.1.6</b> R objects have class</a></li>
<li class="chapter" data-level="4.1.7" data-path="day-0.html"><a href="day-0.html#r-objects-have-structure"><i class="fa fa-check"></i><b>4.1.7</b> R objects have structure</a></li>
<li class="chapter" data-level="4.1.8" data-path="day-0.html"><a href="day-0.html#r-does-what-you-tell-it"><i class="fa fa-check"></i><b>4.1.8</b> R does what you tell it</a></li>
<li class="chapter" data-level="4.1.9" data-path="day-0.html"><a href="day-0.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>4.1.9</b> Keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="day-0.html"><a href="day-0.html#graph-basics"><i class="fa fa-check"></i><b>4.2</b> Graph basics</a><ul>
<li class="chapter" data-level="4.2.1" data-path="day-0.html"><a href="day-0.html#prerequisites-1"><i class="fa fa-check"></i><b>4.2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.2.2" data-path="day-0.html"><a href="day-0.html#tidy-data"><i class="fa fa-check"></i><b>4.2.2</b> Tidy data</a></li>
<li class="chapter" data-level="4.2.3" data-path="day-0.html"><a href="day-0.html#anatomy-of-a-graph"><i class="fa fa-check"></i><b>4.2.3</b> Anatomy of a graph</a></li>
<li class="chapter" data-level="4.2.4" data-path="day-0.html"><a href="day-0.html#layer-smooth-fit"><i class="fa fa-check"></i><b>4.2.4</b> Layer: smooth fit</a></li>
<li class="chapter" data-level="4.2.5" data-path="day-0.html"><a href="day-0.html#layer-log-scale"><i class="fa fa-check"></i><b>4.2.5</b> Layer: log scale</a></li>
<li class="chapter" data-level="4.2.6" data-path="day-0.html"><a href="day-0.html#mapping-aesthetics"><i class="fa fa-check"></i><b>4.2.6</b> Mapping aesthetics</a></li>
<li class="chapter" data-level="4.2.7" data-path="day-0.html"><a href="day-0.html#setting-properties"><i class="fa fa-check"></i><b>4.2.7</b> Setting properties</a></li>
<li class="chapter" data-level="4.2.8" data-path="day-0.html"><a href="day-0.html#layer-facets"><i class="fa fa-check"></i><b>4.2.8</b> Layer: facets</a></li>
<li class="chapter" data-level="4.2.9" data-path="day-0.html"><a href="day-0.html#ordering-the-panels"><i class="fa fa-check"></i><b>4.2.9</b> Ordering the panels</a></li>
<li class="chapter" data-level="4.2.10" data-path="day-0.html"><a href="day-0.html#beyond-the-basics"><i class="fa fa-check"></i><b>4.2.10</b> Beyond the basics</a></li>
<li class="chapter" data-level="4.2.11" data-path="day-0.html"><a href="day-0.html#resize-and-write-to-file"><i class="fa fa-check"></i><b>4.2.11</b> Resize and write to file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-0.html"><a href="day-0.html#data-basics"><i class="fa fa-check"></i><b>4.3</b> Data basics</a></li>
<li class="chapter" data-level="" data-path="day-0.html"><a href="day-0.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>5</b> MIDFIELD Institute Day 1</a><ul>
<li class="chapter" data-level="" data-path="day-1.html"><a href="day-1.html#prerequisites-2"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="day-1.html"><a href="day-1.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>6</b> MIDFIELD Institute Day 2</a><ul>
<li class="chapter" data-level="" data-path="day-2.html"><a href="day-2.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="day-2.html"><a href="day-2.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-0" class="section level1">
<h1><span class="header-section-number">4</span> MIDFIELD Pre-Institute Workshop</h1>
<!-- This file is included in the book only if it is listed in the _bookdown.yml file. -->
<p>Agenda [<a href="midfield-institute-2019.html#day0agenda">link</a>]</p>
<p>This is an <strong>optional session</strong> designed for R novices. If you cannot attend this session on Sunday, you are welcome to work these tutorials on your own before the Monday/Tuesday sessions.</p>
<p>The tutorials give the R novice a quick introduction to three essential elements of data science using R:</p>
<ul>
<li><a href="day-0.html#r-basics">R basics</a></li>
<li><a href="day-0.html#graph-basics">Graph basics</a></li>
<li><a href="day-0.html#data-basics">Data basics</a></li>
</ul>
<p>The tutorials are designed to be completed by an R novice in less than 50 minutes each. The timing has been student-tested, but of course your mileage may vary.</p>
<div id="r-basics" class="section level2">
<h2><span class="header-section-number">4.1</span> R basics</h2>
<img src="figures/logo-R.png" alt="logo" style="left:0px; padding:0px;" height="100px"/>
<p>If the prerequisites have been met, the tutorial should take less than 50 minutes.</p>
<p>An introduction to R adapted from <span class="citation">(Healy, <a href="day-0.html#ref-Healy:2019:Ch.2" role="doc-biblioref">2019</a><a href="day-0.html#ref-Healy:2019:Ch.2" role="doc-biblioref">a</a>)</span> with extra material from <span class="citation">(Matloff, <a href="day-0.html#ref-Matloff:2019" role="doc-biblioref">2019</a>)</span>. If you already have R experience, you might still want to browse this section in case you find something new.</p>
<div id="prerequisites" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Prerequisites</h3>
<ul>
<li>We assume you have completed all of the <a href="getting-started.html#getting-started">Getting started</a> instructions.</li>
<li>Run <code>midfield_institute.Rproj</code> to start every work session</li>
</ul>
<p>Packages</p>
<ul>
<li>Run the following line of code in the RStudio Console to install the <strong>socviz</strong> package.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;kjhealy/socviz&quot;</span>)</code></pre>
<p>Use <em>File &gt; New File &gt; R Script</em> to create a new R script</p>
<ul>
<li>Name the script <code>01-R-basics.R</code> (R filenames can begin with numbers)</li>
<li>Save it in the <code>scripts</code> directory</li>
</ul>
<p>Add a minimal header at the top of the script (if you wish) then use <code>library()</code> to load the packages we will use. Loading all the libraries at the top of a script is conventional practice.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># workshop R basics </span>
<span class="co"># name </span>
<span class="co"># date </span>

<span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;socviz&quot;</span>)</code></pre>
<p>Guidelines</p>
<ul>
<li>In this script type the lines of code in the tutorial below one line at a time.<br />
</li>
<li>After every line, <em>File &gt; Save</em>, and hit the <em>Source</em> button to run the code.<br />
</li>
<li>Confirm that your result matches the result in the tutorial.<br />
</li>
<li><strong>Your turn</strong> exercises give you chance to devise your own examples and check them out. You learn by doing (but you knew that already)!</li>
</ul>
</div>
<div id="everything-in-r-has-a-name" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Everything in R has a name</h3>
<p>In R, every object has a name.</p>
<ul>
<li>named entities, like <code>x</code> or <code>y</code><br />
</li>
<li>data you have loaded, like <code>my_data</code></li>
<li>functions you use, like <code>sin()</code></li>
</ul>
<p>Some names are forbidden</p>
<ul>
<li>reserved words, like <code>TRUE</code> or <code>FALSE</code><br />
</li>
<li>programming words, like <code>Inf</code>, <code>for</code>, <code>else</code>, and <code>function</code><br />
</li>
<li>special entities, like <code>NA</code> and <code>NaN</code></li>
</ul>
<p>Some names should not be used because they name commonly used functions</p>
<ul>
<li><code>q()</code> quit</li>
<li><code>c()</code> combine or concatenate</li>
<li><code>mean()</code></li>
<li><code>range()</code></li>
<li><code>var()</code> variance</li>
</ul>
<p>Names in R are case-sensitive</p>
<ul>
<li><code>my_data</code> and <code>My_Data</code> are different objects</li>
<li>I follow the style guide used in the tidyverse by naming things in lower case, with words separated by underscores, and no spaces</li>
</ul>
<p>If you want to know if a name has already been used in a package you have loaded, go to the RStudio console, type a question mark followed by the name, e.g.,</p>
<ul>
<li><code>? c()</code></li>
<li><code>? mean()</code></li>
</ul>
<p>If the name is in use, a help page appears in the RStudio Help pane.</p>
</div>
<div id="everything-in-r-is-an-object" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Everything in R is an object</h3>
<p>Origins of R objects</p>
<ul>
<li>Some objects are built in to R</li>
<li>Some objects are loaded with packages</li>
<li>Some objects are created by you</li>
</ul>
<p>Type this line of code in your script, Save, Source. <code>c()</code> is the function to combine or concatenate its elements to create a vector.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">25</span>)</code></pre>
<p>In these notes, everything that comes back to us in the Console as the result of running a script is shown prefaced by <code>#&gt;</code>. For example, after running your script, the Console should show,</p>
<pre><code>#&gt; [1]  1  2  3  1  3 25</code></pre>
<p>But what is that <code>[1]</code> here? It’s just a row label. We’ll go into that later, not needed yet.</p>
<p>We can assign the vector to a name.</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">25</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">31</span>, <span class="dv">71</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">21</span>, <span class="dv">6</span>)</code></pre>
<p>To see the result in the Console, type the object name in the script, Save, and Source. (Remember, type the line of code but not the line prefaced by <code>#&gt;</code>—that’s the output line so you can check your results.)</p>
<pre class="sourceCode r"><code class="sourceCode r">x</code></pre>
<pre><code>#&gt; [1]  1  2  3  1  3 25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y</code></pre>
<pre><code>#&gt; [1]  5 31 71  1  3 21  6</code></pre>
<p>You create objects my assigning them names</p>
<ul>
<li><code>&lt;-</code> is the assignment operator (keyboard shortcut: ALT –)</li>
<li>objects exist in your R project workspace, listed in the RStudio Environment pane</li>
</ul>
<img src="figures/rstudio-environment-x-y.png" alt="rstudio new folder" width="700"/>
<p>Datasets are also named objects, and a large number of datasets are included in the base R installation. For example,<code>LakeHuron</code> contains annual measurements of the lake level, in feet, from 1875–1972.</p>
<pre class="sourceCode r"><code class="sourceCode r">LakeHuron</code></pre>
<pre><code>#&gt; Time Series:
#&gt; Start = 1875 
#&gt; End = 1972 
#&gt; Frequency = 1 
#&gt;  [1] 580.38 581.86 580.97 580.80 579.79 580.39 580.42 580.82 581.40 581.32
#&gt; [11] 581.44 581.68 581.17 580.53 580.01 579.91 579.14 579.16 579.55 579.67
#&gt; [21] 578.44 578.24 579.10 579.09 579.35 578.82 579.32 579.01 579.00 579.80
#&gt; [31] 579.83 579.72 579.89 580.01 579.37 578.69 578.19 578.67 579.55 578.92
#&gt; [41] 578.09 579.37 580.13 580.14 579.51 579.24 578.66 578.86 578.05 577.79
#&gt; [51] 576.75 576.75 577.82 578.64 580.58 579.48 577.38 576.90 576.94 576.24
#&gt; [61] 576.84 576.85 576.90 577.79 578.18 577.51 577.23 578.42 579.61 579.05
#&gt; [71] 579.26 579.22 579.38 579.10 577.95 578.12 579.75 580.85 580.41 579.96
#&gt; [81] 579.61 578.76 578.18 577.21 577.13 579.10 578.25 577.91 576.89 575.96
#&gt; [91] 576.80 577.68 578.38 578.52 579.74 579.31 579.89 579.96</code></pre>
<p>Now you can see how the row labels work. There are 10 numbers per row, here, so the second row starts with the 11th, indicated by <code>[11]</code>. The last row starts with the 91st value <code>[91]</code> and ends with the 98th value.</p>
<ul>
<li>In the Console, type <code>? LakeHuron</code> to see the help page for the data set</li>
</ul>
<p>Individual elements of a vector are obtained using <code>[]</code> notation.</p>
<p>For example, the first five lake level readings are extracted with</p>
<pre class="sourceCode r"><code class="sourceCode r">LakeHuron[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</code></pre>
<pre><code>#&gt; [1] 580.38 581.86 580.97 580.80 579.79</code></pre>
<p>The 4th element alone,</p>
<pre class="sourceCode r"><code class="sourceCode r">LakeHuron[<span class="dv">4</span>]</code></pre>
<pre><code>#&gt; [1] 580.8</code></pre>
</div>
<div id="do-things-in-r-using-functions" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Do things in R using functions</h3>
<p>Functions do something useful</p>
<ul>
<li>functions are objects the perform actions for you</li>
<li>functions produce output based on the input it receives</li>
<li>functions are recognized by the parentheses at the end of their names</li>
</ul>
<p>The parentheses are where we include the inputs (arguments) to the function</p>
<ul>
<li><code>c()</code> concatenates the comma-separated numbers in the parentheses to create a vector</li>
<li><code>mean()</code> computes the mean of a vector of numbers</li>
<li><code>sd()</code> computes the standard deviation of a vector of numbers</li>
<li><code>summary()</code> returns a summary of the object</li>
</ul>
<p>If we try <code>mean()</code> with no inputs, we get an error statement</p>
<pre><code>mean()
#&gt; Error in mean.default() : argument &quot;x&quot; is missing, with no default</code></pre>
<p>If we use the Lake Huron dataset as the argument, the function is computed and displayed. Add these lines to your script, Save, and Source.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(LakeHuron)</code></pre>
<pre><code>#&gt; [1] 579.0041</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(LakeHuron)</code></pre>
<pre><code>#&gt; [1] 1.318299</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(LakeHuron)</code></pre>
<pre><code>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   576.0   578.1   579.1   579.0   579.9   581.9</code></pre>
<p>We can extract subsets of data using functions. For example, If we wanted only the first five even-numbered elements, we use <code>c()</code> to create a vector of indices to the desired elements,</p>
<pre class="sourceCode r"><code class="sourceCode r">LakeHuron[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)]</code></pre>
<pre><code>#&gt; [1] 581.86 580.80 580.39 580.82 581.32</code></pre>
<p>If we wanted every 5th entry over the full data set, we use <code>length()</code> to determine how many entries there are, and the sequence function <code>seq()</code> to create the vector of indices,</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">length</span>(LakeHuron)
LakeHuron[<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">5</span>, <span class="dt">to =</span> n, <span class="dt">by =</span> <span class="dv">5</span>)]</code></pre>
<pre><code>#&gt;  [1] 579.79 581.32 580.01 579.67 579.35 579.80 579.37 578.92 579.51 577.79
#&gt; [11] 580.58 576.24 578.18 579.05 577.95 579.96 577.13 575.96 579.74</code></pre>
<p>Because we will be using the ggplot2 package for graphics, we will not be using the base R <code>plot()</code> function very often, but it is useful for a quick look at data. Add these lines to your script, Save, and Source.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(LakeHuron)</code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The help pages for functions are quickly accessed via the Console. In the Console type one line at a time and <em>Enter</em> to see the function help page.</p>
<ul>
<li><code>? mean()</code></li>
<li><code>? sd()</code></li>
<li><code>? summary()</code></li>
</ul>
</div>
<div id="r-functions-come-in-packages" class="section level3">
<h3><span class="header-section-number">4.1.5</span> R functions come in packages</h3>
<p>Functions are bundled in packages</p>
<ul>
<li>Families of useful functions are bundled into packages that you can install, load, and use</li>
<li>Packages allow you to build on the work of others</li>
<li>You can write your own functions and packages too</li>
<li>A lot of the work in data science consists of choosing the right functions and giving them the right arguments to get our data into the form we need for analysis or visualization</li>
</ul>
<p>Functions operate on the input you provide and give you back a result. Type the following in your script, Save, and Source.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(x) <span class="co"># table of counts</span></code></pre>
<pre><code>#&gt; x
#&gt;  1  2  3 25 
#&gt;  2  1  2  1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(y)    <span class="co"># standard deviation</span></code></pre>
<pre><code>#&gt; [1] 25.14435</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x <span class="op">*</span><span class="st"> </span><span class="dv">5</span>    <span class="co"># multiply every element by a scalar</span></code></pre>
<pre><code>#&gt; [1]   5  10  15   5  15 125</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>    <span class="co"># add a scalar to every element</span></code></pre>
<pre><code>#&gt; [1]  6 32 72  2  4 22  7</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x <span class="op">+</span><span class="st"> </span>x    <span class="co"># add elements </span></code></pre>
<pre><code>#&gt; [1]  2  4  6  2  6 50</code></pre>
<p><em>Comments</em> are annotations to make the source code easier for humans to understand but are ignored by R. Comments in R are denoted by a hashtag <code>#</code>.</p>
</div>
<div id="r-objects-have-class" class="section level3">
<h3><span class="header-section-number">4.1.6</span> R objects have class</h3>
<p>Everything is an object and every object has a class.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x)</code></pre>
<pre><code>#&gt; [1] &quot;numeric&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(summary)</code></pre>
<pre><code>#&gt; [1] &quot;function&quot;</code></pre>
<p>Certain actions will change the class of an object. Suppose we try create a vector from the <code>x</code> object and a text string,</p>
<pre class="sourceCode r"><code class="sourceCode r">new_vector &lt;-<span class="st"> </span><span class="kw">c</span>(x, <span class="st">&quot;Apple&quot;</span>)

new_vector</code></pre>
<pre><code>#&gt; [1] &quot;1&quot;     &quot;2&quot;     &quot;3&quot;     &quot;1&quot;     &quot;3&quot;     &quot;25&quot;    &quot;Apple&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(new_vector)</code></pre>
<pre><code>#&gt; [1] &quot;character&quot;</code></pre>
<p>By adding the word “Apple” to the vector, R changed the class from “numeric” to “character”. All the numbers are enclosed in quotes: they are now character strings and cannot be used in calculations.</p>
<p>The most common class of data object we will use is the data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r">titanic <span class="co"># data in the socviz package</span></code></pre>
<pre><code>#&gt;       fate    sex    n percent
#&gt; 1 perished   male 1364    62.0
#&gt; 2 perished female  126     5.7
#&gt; 3 survived   male  367    16.7
#&gt; 4 survived female  344    15.6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(titanic)</code></pre>
<pre><code>#&gt; [1] &quot;data.frame&quot;</code></pre>
<p>You can see there are four variables: fate, sex, n, percent. Two variables (columns) are numeric, two are categorical.</p>
<p>You can pick variable out of a data frame using the <code>$</code> operator,</p>
<pre class="sourceCode r"><code class="sourceCode r">titanic<span class="op">$</span>percent</code></pre>
<pre><code>#&gt; [1] 62.0  5.7 16.7 15.6</code></pre>
<p>From the tidyverse, we will regularly use a augmented data frame called a <em>tibble.</em> We can convert the titanic data frame to a tibble using <code>as_tibble()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">titanic_tb &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(titanic)

<span class="kw">class</span>(titanic_tb)</code></pre>
<pre><code>#&gt; [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">titanic_tb</code></pre>
<pre><code>#&gt; # A tibble: 4 x 4
#&gt;   fate     sex        n percent
#&gt;   &lt;fct&gt;    &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 perished male    1364    62  
#&gt; 2 perished female   126     5.7
#&gt; 3 survived male     367    16.7
#&gt; 4 survived female   344    15.6</code></pre>
<p>The tibble includes additional information about the variables</p>
</div>
<div id="r-objects-have-structure" class="section level3">
<h3><span class="header-section-number">4.1.7</span> R objects have structure</h3>
<p>To see inside an object ask for its structure using the <code>str()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(x)</code></pre>
<pre><code>#&gt;  num [1:6] 1 2 3 1 3 25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(titanic)</code></pre>
<pre><code>#&gt; &#39;data.frame&#39;:    4 obs. of  4 variables:
#&gt;  $ fate   : Factor w/ 2 levels &quot;perished&quot;,&quot;survived&quot;: 1 1 2 2
#&gt;  $ sex    : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 2 1
#&gt;  $ n      : num  1364 126 367 344
#&gt;  $ percent: num  62 5.7 16.7 15.6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(titanic_tb)</code></pre>
<pre><code>#&gt; Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    4 obs. of  4 variables:
#&gt;  $ fate   : Factor w/ 2 levels &quot;perished&quot;,&quot;survived&quot;: 1 1 2 2
#&gt;  $ sex    : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 2 1 2 1
#&gt;  $ n      : num  1364 126 367 344
#&gt;  $ percent: num  62 5.7 16.7 15.6</code></pre>
<p>I also like to use the <code>glimpse()</code> function from the tidyverse.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(x)</code></pre>
<pre><code>#&gt;  num [1:6] 1 2 3 1 3 25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(titanic)</code></pre>
<pre><code>#&gt; Observations: 4
#&gt; Variables: 4
#&gt; $ fate    &lt;fct&gt; perished, perished, survived, survived
#&gt; $ sex     &lt;fct&gt; male, female, male, female
#&gt; $ n       &lt;dbl&gt; 1364, 126, 367, 344
#&gt; $ percent &lt;dbl&gt; 62.0, 5.7, 16.7, 15.6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(titanic_tb) </code></pre>
<pre><code>#&gt; Observations: 4
#&gt; Variables: 4
#&gt; $ fate    &lt;fct&gt; perished, perished, survived, survived
#&gt; $ sex     &lt;fct&gt; male, female, male, female
#&gt; $ n       &lt;dbl&gt; 1364, 126, 367, 344
#&gt; $ percent &lt;dbl&gt; 62.0, 5.7, 16.7, 15.6</code></pre>
</div>
<div id="r-does-what-you-tell-it" class="section level3">
<h3><span class="header-section-number">4.1.8</span> R does what you tell it</h3>
<p>Expect to make errors and don’t worry when that happens. You won’t break anything. Healy <span class="citation">(<a href="day-0.html#ref-Healy:2019" role="doc-biblioref">2019</a><a href="day-0.html#ref-Healy:2019" role="doc-biblioref">b</a>)</span> offers this advice for three specific things to watch out for:</p>
<ul>
<li>Make sure parentheses are balanced—that every opening <code>(</code> has a corresponding closing <code>)</code>.<br />
</li>
<li>Make sure you complete your expressions. If you see a <code>+</code> in the Console instead of the usual prompt <code>&gt;</code>, that means that R thinks you haven’t written a complete expression. You can hit <code>Esc</code> or <code>Ctrl C</code> to force your way back to the Console and try correcting the code.<br />
</li>
<li>In ggplot specifically, as you will see, we create plots layer by layer, using a <code>+</code> character at the end of the line—not at the beginning of the next line.</li>
</ul>
<p>For example, you would write this,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre>
<p>not this,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># error caused by incorrectly placed +</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))  
    <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre>
<p>To conclude, let’s make bar graph of the <code>titanic</code> data,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> titanic_tb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> sex, <span class="dt">y =</span> n, <span class="dt">fill =</span> fate)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">coord_flip</span>()</code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<blockquote>
<p><strong>Your turn.</strong> As shown, color distinguishes those who survived from those who did not and bar length gives totals by sex. Make a small change so that color denotes sex and bar length gives totals of survived and perished.</p>
</blockquote>
</div>
<div id="keyboard-shortcuts" class="section level3">
<h3><span class="header-section-number">4.1.9</span> Keyboard shortcuts</h3>
<p>In Windows,</p>
<ul>
<li><code>Ctrl L</code> clears the Console<br />
</li>
<li><code>Alt -</code> creates the assignment operator <code>&lt;-</code><br />
</li>
<li><code>Ctrl Enter</code> runs the selected line(s) of code in an R script</li>
</ul>
<p>Feel free to take a break before starting the next tutorial.</p>
</div>
</div>
<div id="graph-basics" class="section level2">
<h2><span class="header-section-number">4.2</span> Graph basics</h2>
<p><img src="figures/cm201-01.png" alt="logo" style="left:0px; padding:0px;" width="400"/>
<small>
<br>
<i>Decline</i> by Randall Munroe (xkcd.com) is licensed under <a href="https://creativecommons.org/licenses/by-nc/2.5/">CC BY-NC 2.5</a>
<br>
</small></p>
<p>If the prerequisites have been met, the tutorial should take less than 50 minutes.</p>
<p>An introduction to ggplot2 adapted from Chapter 3 from <span class="citation">(Healy, <a href="day-0.html#ref-Healy:2019" role="doc-biblioref">2019</a><a href="day-0.html#ref-Healy:2019" role="doc-biblioref">b</a>)</span>. If you already have R experience, you might still want to browse this section in case you find something new.</p>
<div id="prerequisites-1" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Prerequisites</h3>
<ul>
<li>We assume you have completed all of the <a href="getting-started.html#getting-started">Getting started</a> instructions.</li>
<li>Run <code>midfield_institute.Rproj</code> to start every work session</li>
</ul>
<p>Packages</p>
<ul>
<li>If any of these packages have not yet been installed, they can be installed using these commands,</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;gapminder&quot;</span>) </code></pre>
<p>Use <em>File &gt; New File &gt; R Script</em> to create a new R script</p>
<ul>
<li>Name the script <code>02-graph-basics.R</code><br />
</li>
<li>Save it in the <code>scripts</code> directory</li>
</ul>
<p>Add a minimal header at the top of the script (if you wish) then use <code>library()</code> to load the packages we will use. Loading all the libraries at the top of a script is conventional practice.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># workshop graph basics </span>
<span class="co"># name </span>
<span class="co"># date </span>

<span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;gapminder&quot;</span>)</code></pre>
<p>Guidelines</p>
<ul>
<li>In this script type the lines of code in the tutorial below one line at a time.<br />
</li>
<li>After every line, <em>File &gt; Save</em>, and hit the <em>Source</em> button to run the code.<br />
</li>
<li>Confirm that your result matches the result in the tutorial.<br />
</li>
<li><strong>Your turn</strong> exercises give you chance to devise your own examples and check them out. You learn by doing (but you knew that already)!</li>
</ul>
</div>
<div id="tidy-data" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Tidy data</h3>
<p>If the data set is “tidy”, then every row is an observation and every column is a variable. The <code>gapminder</code> data frame is tidy. We use <code>glimpse()</code> to get a look at the structure.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(gapminder)</code></pre>
<pre><code>#&gt; Observations: 1,704
#&gt; Variables: 6
#&gt; $ country   &lt;fct&gt; Afghanistan, Afghanistan, Afghanistan, Afghanistan, ...
#&gt; $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia...
#&gt; $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992...
#&gt; $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.8...
#&gt; $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 1488...
#&gt; $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 78...</code></pre>
<p>And we can just type its name to see the first few rows,</p>
<pre class="sourceCode r"><code class="sourceCode r">gapminder</code></pre>
<pre><code>#&gt; # A tibble: 1,704 x 6
#&gt;    country     continent  year lifeExp      pop gdpPercap
#&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
#&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.
#&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.
#&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.
#&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.
#&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.
#&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.
#&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.
#&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.
#&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.
#&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.
#&gt; # ... with 1,694 more rows</code></pre>
<p>Read more about <a href="https://r4ds.had.co.nz/tidy-data.html#tidy-data-1">tidy data</a> in <span class="citation">(Wickham and Grolemund, <a href="day-0.html#ref-Wickham+Grolemund:2017" role="doc-biblioref">2017</a>)</span>.</p>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> The ggplot2 package includes a dataset called <code>mpg</code>.</p>
<ul>
<li>Use <code>glimpse()</code> to examine the data set.</li>
<li>How many variables? How many observations?</li>
<li>How many of the variables are numeric? How many are character type?</li>
<li>Is the data set tidy?</li>
</ul>
<p><em>Check your work.</em> There are 234 observations and 11 variables.</p>
</blockquote>
</div>
<div id="anatomy-of-a-graph" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Anatomy of a graph</h3>
<p><code>ggplot()</code> is a our basic plotting function. The <code>data = ...</code> argument assigns the data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder)</code></pre>
<p>Next we use the mapping argument <code>mapping = aes(...)</code> to assign variables (column names) from the data frame to specific aesthetic properties of the graph such as the x-coordinate, the y-coordinate color, fill, etc.</p>
<p>Here we will map the GDP per capita variable to <code>x</code> and the life expectancy variable to <code>y</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp))</code></pre>
<p>If we try to print the graph by typing the name of the graph object (everything in R is an object), we get an empty graph because we haven’t told ggplot what sort of a graph we want.</p>
<pre class="sourceCode r"><code class="sourceCode r">p</code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Because the graph will be a scatterplot, we add the <code>geom_point()</code> layer.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="kw">geom_point</span>()

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In ggplot2, “geoms” are geometric objects such as points, lines, bars, boxplots, contours, polygons, etc. You can browse the full list on the ggplot2 <a href="https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms">geom reference page</a>.</p>
<p>We could also have simply added the layer to the original object,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>()

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Notice that the default axis labels are the variables names from the data frame. We can edit those with another layer</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Or, with all layers shown in one code chunk,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Summary. The basics steps for building up the layers of any graph consist of,</p>
<ul>
<li>assign the data frame</li>
<li>map variables (columns names) to aesthetic properties<br />
</li>
<li>choose geoms<br />
</li>
<li>adjust scales, labels, etc.</li>
</ul>
<p>For more information</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a> help page</li>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a> help page</li>
<li><a href="https://ggplot2.tidyverse.org/reference/labs.html">geom_labs()</a> help page</li>
</ul>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong></p>
<ul>
<li>In the console, type <code>? mpg</code> to see the data set help page. Skim the descriptions of the variables.<br />
</li>
<li>Create a scatterplot of highway miles per gallon as a function of engine displacement in liters.</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="layer-smooth-fit" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Layer: smooth fit</h3>
<p>Suppose you wanted a smooth fit curve, not necessarily linear. Add a <code>geom_smooth()</code> layer. The name <em>loess</em> (pronounced like the proper name Lois) is a nonparametric curve-fitting method based on <em>local regression</em>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The <code>se</code> argument controls whether or not the confidence interval is displayed. Setting <code>se = TRUE</code> yields,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-39-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For a linear-fit layer, we add a layer with <code>method</code> set to <code>lm</code> (short for linear model). The linear fit is not particularly good in this case, but now you know how to do one.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For more information</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a> help page</li>
</ul>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Add a loess curve fit with a confidence interval.</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="layer-log-scale" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Layer: log scale</h3>
<p>We have orders of magnitude differences in the GDP per capita variable. To confirm, we can <code>summarize()</code> the <code>gdpPercap</code> variable. The output shows that the minimum is 241, the median 3532, and the maximum 113523.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># extract one variable from the data frame </span>
this_variable &lt;-<span class="st"> </span>gapminder[<span class="st">&quot;gdpPercap&quot;</span>]

<span class="co"># staistical summary of one variable </span>
<span class="kw">summary</span>(this_variable)</code></pre>
<pre><code>#&gt;    gdpPercap       
#&gt;  Min.   :   241.2  
#&gt;  1st Qu.:  1202.1  
#&gt;  Median :  3531.8  
#&gt;  Mean   :  7215.3  
#&gt;  3rd Qu.:  9325.5  
#&gt;  Max.   :113523.1</code></pre>
<p>The bracket notation I just used, <code>gapminder["gdpPercap"]</code>, is one way to extract a variable from a data frame.</p>
<p>In exploring a graph like this, it might be useful to add a layer that changes the horizontal scale to a log-base-10 scale.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>() 

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The scales package allows us to change the GDP scale to dollars. Using the syntax <code>thepackage::thefunction</code> we can use the <code>scales::dollar</code> function without loading the scales package.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-45-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In this case, a linear fit might work,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Update the axis labels,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (log10 scale)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># display the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In summary, all the layers could have been be coded at once, for example,</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (log10 scale)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)</code></pre>
<p>With all the layers in one place, we can see that we’ve coded all the basic steps, that is,</p>
<ul>
<li>assign the data frame</li>
<li>map variables (columns names) to aesthetic properties<br />
</li>
<li>choose geoms</li>
<li>adjust scales, labels, etc.</li>
</ul>
<p>For more information</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10()</a> help page</li>
</ul>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Edit the axis labels to include units.</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="mapping-aesthetics" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Mapping aesthetics</h3>
<p>So far, we have mapped variables only to the x-coordinate and y-coordinate aesthetics.</p>
<p>If we map a variable to the color aesthetic, the data symbols are automatically assigned different colors and a legend is created. I this example, we map the <code>continent</code> variable to color.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, 
                <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp, <span class="dt">color =</span> continent)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-50-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Map vehicle class to color</li>
<li>Change the curve fit to linear</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="setting-properties" class="section level3">
<h3><span class="header-section-number">4.2.7</span> Setting properties</h3>
<p>Because the colors overprint, we might try making the data symbols slightly transparent. In this case, we are not mapping a property to a variable; instead, we want all data symbols to be less opaque.</p>
<p>The <code>alpha</code> argument, with <span class="math inline">\(0 \leq \alpha \leq 1\)</span>, sets the transparency level. Because this change applies to all data points equally, we assign it in the geom, not <code>aes()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, 
                <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp, <span class="dt">color =</span> continent)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-52-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>If we add a linear fit to these data, a fit for each continent is generated. For a thinner line, I’ve added a <code>size</code> argument to the geom.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>)

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-53-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>If we want all the data markers the same color but we want to change the color, we don’t map it, we set it in the geom.</p>
<p>Here, I’ve omitted the aesthetic mapping to color and used a color assignment in the geom.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">color =</span> <span class="st">&quot;purple1&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;purple4&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (log10 scale)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>)

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-54-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For more information</p>
<ul>
<li><a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">R color names</a></li>
</ul>
</div>
<div id="layer-facets" class="section level3">
<h3><span class="header-section-number">4.2.8</span> Layer: facets</h3>
<p>In the earlier graph where we mapped continent to color, there was a lot of overprinting, making it difficult to compare the continents.</p>
<p>The <code>facet_wrap()</code> layer separates the data into different panels (or facets). Like the <code>aes()</code> mapping, <code>facet_wrap()</code> is applied to a variable (column name) in the data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="kw">vars</span>(continent))

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-55-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Comparisons are facilitated by having the facets appear in one column, by using the <code>ncols</code> argument of <code>facet_wrap()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="kw">vars</span>(continent), <span class="dt">ncol =</span> <span class="dv">1</span>)

p <span class="co"># print the graph</span></code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>In a faceted display, all panels have identical scales (the default) to facilitate comparison.</p>
<p>Again, all the layers could have been be coded at once, for example,</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">color =</span> <span class="st">&quot;purple1&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;purple4&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="kw">vars</span>(continent), <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (log10 scale)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>) </code></pre>
<p>For more information</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a> help page</li>
</ul>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Map drive type to color</li>
<li>Facet on vehicle class</li>
<li>Add some transparency to the data symbols</li>
<li>Omit the smooth fit</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-58-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="ordering-the-panels" class="section level3">
<h3><span class="header-section-number">4.2.9</span> Ordering the panels</h3>
<p>The default ordering of the panels in this example is alphabetical. In most cases, ordering the panels by the data (often the mean of the median) improves the display.</p>
<p>Here we have two quantitative variables, but the one that is the more interesting is life expectancy. Our goal then is to order the <code>continent</code> variable by the median of the <code>lifeExp</code> variable in each panel.</p>
<p>To do that, we require continent to be a <em>factor</em>, a type of variable specialized for creating ordered levels of a category. Using <code>gimpse()</code> we see that continent is already a factor (<code>&lt;fct&gt;</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(gapminder)</code></pre>
<pre><code>#&gt; Observations: 1,704
#&gt; Variables: 6
#&gt; $ country   &lt;fct&gt; Afghanistan, Afghanistan, Afghanistan, Afghanistan, ...
#&gt; $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia...
#&gt; $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992...
#&gt; $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.8...
#&gt; $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 1488...
#&gt; $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 78...</code></pre>
<p>Therefore all we have to do is tell R that we want the levels of continent ordered by the median of life expectancy using the <code>fct)reorder()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">continent =</span> <span class="kw">fct_reorder</span>(continent, lifeExp, median))</code></pre>
<p>In doing so, I’ve overwritten the original gapminder dataset with my revised version.</p>
<p>We set the <code>as.table</code> argument to false to place the panel with the highest life expectancy in the top position.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">color =</span> <span class="st">&quot;purple1&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;purple4&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="kw">vars</span>(continent), <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">as.table =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">scale_x_log10</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (log10 scale)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>) </code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For more information</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a> help page</li>
<li><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder()</a> help page</li>
</ul>
<p><br></p>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Convert <code>class</code> to a factor ordered by the mean highway mileage</li>
<li>Same graph as before, but order the panels by mean fuel consumption</li>
</ul>
<p><em>Check your work:</em></p>
</blockquote>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-62-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="beyond-the-basics" class="section level3">
<h3><span class="header-section-number">4.2.10</span> Beyond the basics</h3>
<p>Demonstrating how the basics can be built upon to create a complex data graphic.</p>
<p>To wrap up this introduction, I’ll show you how we can use functions in various layers to show all the data in every panel; add a common overall loess smooth fit; and highlight the the continent data in each panel, making it easier to compare each continent to the global data.</p>
<p>Because life expectancy has generally increased over time, I’m going to restrict this final graph to 2007, the most recent year in this dataset.</p>
<p>Typing this code in your script is optional. Without further explanation, here’s the code.</p>
<pre class="sourceCode r"><code class="sourceCode r">gapminder &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2007</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> gapminder, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x  =</span> gdpPercap <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="dt">y =</span> lifeExp)) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">select</span>(gapminder, <span class="op">-</span>continent),
                <span class="dt">size  =</span> <span class="fl">1.25</span>,
                <span class="dt">alpha =</span> <span class="fl">0.5</span>, 
                <span class="dt">color =</span> <span class="st">&quot;#80cdc1&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> <span class="kw">select</span>(gapminder, <span class="op">-</span>continent),
                <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>,
                <span class="dt">se    =</span> <span class="ot">FALSE</span>,
                <span class="dt">size  =</span> <span class="fl">0.7</span>,
                <span class="dt">color =</span> <span class="st">&quot;#80cdc1&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> continent),
                <span class="dt">size  =</span> <span class="fl">1.25</span>,
                <span class="dt">color =</span> <span class="st">&quot;#01665e&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(continent),
                <span class="dt">ncol =</span> <span class="dv">1</span>,
                <span class="dt">as.table =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (thousands of dollars)&quot;</span>,
                <span class="dt">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>,
                <span class="dt">title  =</span> <span class="st">&quot;Life expectancy by country, 2007&quot;</span>,
                <span class="dt">caption =</span> <span class="st">&quot;Source: Gapminder&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre>
<p><img src="midfield-workshops_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>For more information</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a> help page</li>
<li><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a> help page</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-themes">theme()</a> help page</li>
<li><a href="http://colorbrewer2.org/">ColorBrewer</a> for color hex codes</li>
</ul>
</div>
<div id="resize-and-write-to-file" class="section level3">
<h3><span class="header-section-number">4.2.11</span> Resize and write to file</h3>
<p>For consistent control over the size and aspect ratio of your publication-ready graph, you should always conclude your design by saving the image and sizing it at the same time.</p>
<p>Here, we save the figure to the <code>figures</code> directory we set up earlier.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;figures/02-graph-basics-gapminder.png&quot;</span>, 
        <span class="dt">width  =</span> <span class="fl">6.5</span>,
        <span class="dt">height =</span> <span class="fl">10.5</span>,
        <span class="dt">units  =</span> <span class="st">&quot;in&quot;</span>, 
        <span class="dt">dpi    =</span> <span class="dv">300</span>)</code></pre>
<p>And the final figure looks like this:</p>
<img src="figures/02-graph-basics-gapminder.png" alt="figures/02-graph-basics-gapminder" style="display: block; margin-left: auto; margin-right: auto;" width="500px"/>
<p>For more information</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a> help page</li>
</ul>
<blockquote>
<p><strong>Your turn.</strong> Continue to practice with <code>mpg</code>.</p>
<ul>
<li>Write your ggsave() code chunk immediately following the ggplot() code chunk of the graph you want to save.</li>
<li>Use ggsave to write your graph to the <code>figures</code> directory with the name <code>02-graph-basics-mpg.png</code></li>
<li>Try a 6 in by 6 in figure size</li>
</ul>
<p><em>Check your work:</em> Navigate to your <code>figures</code> folder. The new png file should be there. Open it to confirm it is the figure you expect.</p>
</blockquote>
<p><br>
Feel free to take a break before starting the next tutorial.</p>
</div>
</div>
<div id="data-basics" class="section level2">
<h2><span class="header-section-number">4.3</span> Data basics</h2>
<p><img src="figures/sd011-14.png" alt="logo" style="left:0px; padding:0px;" height="200"/><img src="figures/sd011-14b.png" alt="logo" style="left:0px; padding:0px;" height="200"/></p>
<p>If the prerequisites have been met, the tutorial should take less than 50 minutes.</p>
</div>
<div id="references-1" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs">
<div id="ref-Healy:2019:Ch.2">
<p>Healy K (2019a) Get Started. <em>Data Visualization: A Practical Introduction</em>. Princeton University Press, Princeton, NJ, 32–53</p>
</div>
<div id="ref-Healy:2019">
<p>Healy K (2019b) <em>Data Visualization: A Practical Introduction.</em> Princeton University Press, Princeton, NJ <a href="https://kieranhealy.org/publications/dataviz/">https://kieranhealy.org/publications/dataviz/</a></p>
</div>
<div id="ref-Matloff:2019">
<p>Matloff N (2019) fasteR: Fast Lane to Learning R! <a href="https://github.com/matloff/fasteR">https://github.com/matloff/fasteR</a></p>
</div>
<div id="ref-Wickham+Grolemund:2017">
<p>Wickham H and Grolemund G (2017) <em>R for Data Science.</em> O’Reilly Media, Inc., Sebastopol, CA <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a></p>
</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-day-00.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["midfield-workshops.pdf", "midfield-workshops.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
